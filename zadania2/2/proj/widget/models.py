import urllib2
import json
import re

class Device:
	""" Klasa opisujaca urzadzenie """

	def __init__(self, device):
		""" Inicjalizuje instancje danymi pobranymi z uslugi REST """
		self.dev = device
		self.update()

	def update(self):
		""" Aktualizuje liste atrybutow urzadzenia """
		#r = urllib2.urlopen('https://192.168.105.140:443/Tango/rest/192.168.130.200:10000/Device/' + self.dev + '/get_attribute_list')
		#response = r.read()
		# --------------dane do testow
		response = ' {"attCount": 16,"attribute0": "VoltageTarget","attScalar0": true,"attValue0": "7000.0","attWritable0": true,"attPlotable0": false,"isNumeric0": true, "attDesc0": "Name: VoltageTarget\nLabel: VoltageTarget\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMinalarm: Not specified\nMax alarm: Not specified\nDescription: None","attribute1": "SetPointEnabled","attScalar1": true,"attValue1": "true","attWritable1": true,"attPlotable1": false,"isNumeric1": false,"attDesc1": "Name: SetPointEnabled\nLabel: SetPointEnabled\nWritable: READ_WRITE\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: None","attribute2": "CalibrationFactor","attScalar2": true,"attValue2": "1.0","attWritable2": true,"attPlotable2": false,"isNumeric2": true,"attDesc2": "Name: CalibrationFactor\nLabel: CalibrationFactor\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: 1\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: None","attribute3": "PumpSize","attScalar3": true,"attValue3": "80.0","attWritable3": true,"attPlotable3": false,"isNumeric3": true,"attDesc3": "Name: PumpSize\nLabel: PumpSize\nWritable: READ_WRITE\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: l/s\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute4": "SetPointOffPressure","attScalar4": true,"attValue4": "1.6E-7","attWritable4": true,"attPlotable4": false,"isNumeric4": true,"attDesc4": "Name: SetPointOffPressure\nLabel: SetPointOffPressure\nWritable: READ_WRITE\nDataformat: Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: mBar\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMinalarm: Not specified\nMax alarm: Not specified\nDescription: None","attribute5": "SetPointActive","attScalar5": true,"attValue5": "true","attWritable5": false,"attPlotable5": false,"isNumeric5": false,"attDesc5": "Name: SetPointActive\nLabel: SetPointActive\nWritable: READ\nData format: Scalar\nDatatype: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: Nodisplay unit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: None","attribute6": "Current","attScalar6": true,"attValue6": "7.9E-8","attWritable6": false,"attPlotable6": false,"isNumeric6": true,"attDesc6": "Name: Current\nLabel: Current\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: A\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute7": "Pressure","attScalar7": true,"attValue7": "6.9E-11","attWritable7": false,"attPlotable7": false,"isNumeric7": true,"attDesc7": "Name: Pressure\nLabel: Pressure\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: mBar\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute8": "Voltage","attScalar8": true,"attValue8": "7000.0","attWritable8": false,"attPlotable8": false,"isNumeric8": true,"attDesc8": "Name: Voltage\nLabel: Voltage\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute9": "SetPointOnPressure","attScalar9": true,"attValue9": "1.3E-7","attWritable9": true,"attPlotable9": false,"isNumeric9": true,"attDesc9": "Name: SetPointOnPressure\nLabel: SetPointOnPressure\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: mBar\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: None","attribute10": "Model","attScalar10": true,"attValue10": "DIGITEL SPCe","attWritable10": false,"attPlotable10": false,"isNumeric10": false,"attDesc10": "Name: Model\nLabel: Model\nWritable: READ\nData format: Scalar\nData type:DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm:Not specified\nDescription: No description","attribute11": "FirmwareVersion","attScalar11": true,"attValue11": "1.16.04","attWritable11": false,"attPlotable11": false,"isNumeric11": false,"attDesc11": "Name: FirmwareVersion\nLabel: FirmwareVersion\nWritable: READ\nData format:Scalar\nData type: DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute12": "Alarm","attScalar12": true,"attValue12": "false","attWritable12": false,"attPlotable12": false,"isNumeric12": false,"attDesc12": "Name: Alarm\nLabel: Alarm\nWritable: READ\nData format: Scalar\nData type:DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute13": "Bypass","attScalar13": true,"attValue13": "false","attWritable13": true,"attPlotable13": false,"isNumeric13": false,"attDesc13": "Name: Bypass\nLabel: Bypass\nWritable: READ_WRITE\nData format: Scalar\nData type:DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute14": "State","attScalar14": true,"attValue14": "ON","attWritable14": false,"attPlotable14": false,"isNumeric14": false,"attDesc14": "Name: State\nLabel: State\nWritable: READ\nData format: Scalar\nData type: State\nMax DimX: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Notspecified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Notspecified\nDescription: No description","attribute15": "Status","attScalar15": true,"attValue15": "Connection OK\nPump is running\nSet point is active","attWritable15": false,"attPlotable15": false,"isNumeric15": false,"attDesc15": "Name: Status\nLabel: Status\nWritable: READ\nData format: Scalar\nData type:DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm:Not specified\nDescription: No description","connectionStatus": "OK"} '
		# --------------dane do testow

		self.attList = json.loads(re.sub(r'\n', '&#13;', response))		# zamieniam \n na line break dla tooltipow HTML

