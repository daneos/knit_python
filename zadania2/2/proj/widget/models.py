import urllib2
import json
import re

class Device:
	""" Klasa opisujaca urzadzenie """

	def __init__(self, device, testing):
		""" Inicjalizuje instancje danymi pobranymi z uslugi REST
			Jesli parametr testing ma wartosc True, pracuje na danych testowych
			zamiast laczenia sie z usluga """
		self.dev = device
		self._testing = testing
		self.error = None
		self.update()

	def update(self):
		""" Aktualizuje liste atrybutow urzadzenia """
		if not self._testing:
			try:
				r = urllib2.urlopen('https://192.168.105.140:443/Tango/rest/192.168.130.200:10000/Device/' + self.dev + '/get_attribute_list')
				response = r.read()
			except Exception as e:
				self.error = "Could not read data from REST service:<br>" + str(e)
				return
		else:
			# --------------dane do testow
			if self.dev == 'R1-SGB/VAC/R1-SGBCAB08-VAC-IPCU01':
				response = ' {"attCount": 16,"attribute0": "VoltageTarget","attScalar0": true,"attValue0": "7000.0","attWritable0": true,"attPlotable0": false,"isNumeric0": true, "attDesc0": "Name: VoltageTarget\nLabel: VoltageTarget\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMinalarm: Not specified\nMax alarm: Not specified\nDescription: None","attribute1": "SetPointEnabled","attScalar1": true,"attValue1": "true","attWritable1": true,"attPlotable1": false,"isNumeric1": false,"attDesc1": "Name: SetPointEnabled\nLabel: SetPointEnabled\nWritable: READ_WRITE\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: None","attribute2": "CalibrationFactor","attScalar2": true,"attValue2": "1.0","attWritable2": true,"attPlotable2": false,"isNumeric2": true,"attDesc2": "Name: CalibrationFactor\nLabel: CalibrationFactor\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: 1\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: None","attribute3": "PumpSize","attScalar3": true,"attValue3": "80.0","attWritable3": true,"attPlotable3": false,"isNumeric3": true,"attDesc3": "Name: PumpSize\nLabel: PumpSize\nWritable: READ_WRITE\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: l/s\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute4": "SetPointOffPressure","attScalar4": true,"attValue4": "1.6E-7","attWritable4": true,"attPlotable4": false,"isNumeric4": true,"attDesc4": "Name: SetPointOffPressure\nLabel: SetPointOffPressure\nWritable: READ_WRITE\nDataformat: Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: mBar\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMinalarm: Not specified\nMax alarm: Not specified\nDescription: None","attribute5": "SetPointActive","attScalar5": true,"attValue5": "true","attWritable5": false,"attPlotable5": false,"isNumeric5": false,"attDesc5": "Name: SetPointActive\nLabel: SetPointActive\nWritable: READ\nData format: Scalar\nDatatype: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: Nodisplay unit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: None","attribute6": "Current","attScalar6": true,"attValue6": "7.9E-8","attWritable6": false,"attPlotable6": false,"isNumeric6": true,"attDesc6": "Name: Current\nLabel: Current\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: A\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute7": "Pressure","attScalar7": true,"attValue7": "6.9E-11","attWritable7": false,"attPlotable7": false,"isNumeric7": true,"attDesc7": "Name: Pressure\nLabel: Pressure\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: mBar\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute8": "Voltage","attScalar8": true,"attValue8": "7000.0","attWritable8": false,"attPlotable8": false,"isNumeric8": true,"attDesc8": "Name: Voltage\nLabel: Voltage\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: None","attribute9": "SetPointOnPressure","attScalar9": true,"attValue9": "1.3E-7","attWritable9": true,"attPlotable9": false,"isNumeric9": true,"attDesc9": "Name: SetPointOnPressure\nLabel: SetPointOnPressure\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: mBar\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %1.2e\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: None","attribute10": "Model","attScalar10": true,"attValue10": "DIGITEL SPCe","attWritable10": false,"attPlotable10": false,"isNumeric10": false,"attDesc10": "Name: Model\nLabel: Model\nWritable: READ\nData format: Scalar\nData type:DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm:Not specified\nDescription: No description","attribute11": "FirmwareVersion","attScalar11": true,"attValue11": "1.16.04","attWritable11": false,"attPlotable11": false,"isNumeric11": false,"attDesc11": "Name: FirmwareVersion\nLabel: FirmwareVersion\nWritable: READ\nData format:Scalar\nData type: DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute12": "Alarm","attScalar12": true,"attValue12": "false","attWritable12": false,"attPlotable12": false,"isNumeric12": false,"attDesc12": "Name: Alarm\nLabel: Alarm\nWritable: READ\nData format: Scalar\nData type:DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute13": "Bypass","attScalar13": true,"attValue13": "false","attWritable13": true,"attPlotable13": false,"isNumeric13": false,"attDesc13": "Name: Bypass\nLabel: Bypass\nWritable: READ_WRITE\nData format: Scalar\nData type:DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute14": "State","attScalar14": true,"attValue14": "ON","attWritable14": false,"attPlotable14": false,"isNumeric14": false,"attDesc14": "Name: State\nLabel: State\nWritable: READ\nData format: Scalar\nData type: State\nMax DimX: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Notspecified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Notspecified\nDescription: No description","attribute15": "Status","attScalar15": true,"attValue15": "Connection OK\nPump is running\nSet point is active","attWritable15": false,"attPlotable15": false,"isNumeric15": false,"attDesc15": "Name: Status\nLabel: Status\nWritable: READ\nData format: Scalar\nData type:DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm:Not specified\nDescription: No description","connectionStatus": "OK"} '
			elif self.dev == 'R1-C134/MAG/R1-C134-MAG-PS1':
				response = ' {"attCount": 47,"attribute0": "Current","attScalar0": true,"attValue0": "0.05100051000510005","attWritable0": true,"attPlotable0": false,"isNumeric0": true,"attDesc0": "Name: Current\nLabel: Output current\nWritable: READ_WRITE\nData format: Scalar\nDatatype: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: A\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: 0\nMax value: 286\nMin alarm: Not specified\nMax alarm: Notspecified\nDescription: When read provides the measured output current, when written sets the desidered set-point for the output current.","attribute1": "Voltage","attScalar1": true,"attValue1": "0.0","attWritable1": false,"attPlotable1": false,"isNumeric1": true,"attDesc1": "Name: Voltage\nLabel: Output voltage\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: When read provides the measured output voltage. The attribute is read only.","attribute2": "CurrentSetPoint","attScalar2": true,"attValue2": "0.0","attWritable2": false,"attPlotable2": false,"isNumeric2": true,"attDesc2": "Name: CurrentSetPoint\nLabel: Desidered output current\nWritable: READ\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: A\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: Read the desidered set-point for the output current","attribute3": "CurrentSlewRate","attScalar3": true,"attValue3": "1.55","attWritable3": true,"attPlotable3": false,"isNumeric3": true,"attDesc3": "Name: CurrentSlewRate\nLabel: Current slewrate\nWritable: READ_WRITE\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: A/s\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %6.2f\nMin value: 0\nMax value: 1.5504\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: Read and set the desidered slew rate for the current.","attribute4": "Tesla","attScalar4": true,"attValue4": "0.01","attWritable4": false,"attPlotable4": false,"isNumeric4": true,"attDesc4": "Name: Tesla\nLabel: Tesla\nWritable: READ\nData format: Scalar\nData type: DevDouble\nMaxDim X: 1\nMax Dim Y: 0\nUnit: T\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat:%6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Notspecified\nDescription: Read the ambient temperature","attribute5": "PositivePolarity","attScalar5": true,"attValue5": "false","attWritable5": false,"attPlotable5": false,"isNumeric5": false,"attDesc5": "Name: PositivePolarity\nLabel: Polarity is positive\nWritable: READ\nData format: Scalar\nDatatype: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: Nodisplay unit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: Enabled if the output polarity is positive.","attribute6": "InternalPlus15Vsupply","attScalar6": true,"attValue6": "15.0","attWritable6": false,"attPlotable6": false,"isNumeric6": true,"attDesc6": "Name: InternalPlus15Vsupply\nLabel: Internal 15V supply\nWritable: READ\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: Value of the internal 15V supply.","attribute7": "InternalMinus15Vsupply","attScalar7": true,"attValue7": "15.1","attWritable7": false,"attPlotable7": false,"isNumeric7": true,"attDesc7": "Name: InternalMinus15Vsupply\nLabel: Internal minus 15V supply\nWritable: READ\nDataformat: Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMinalarm: Not specified\nMax alarm: Not specified\nDescription: Value of the internal -15V supply.","attribute8": "DeltaTemperature","attScalar8": true,"attValue8": "0.0","attWritable8": false,"attPlotable8": false,"isNumeric8": true,"attDesc8": "Name: DeltaTemperature\nLabel: Delta temperature\nWritable: READ\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: Degrees C.\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMinalarm: Not specified\nMax alarm: Not specified\nDescription: Delta temperature","attribute9": "InternalPlus5Vsupply","attScalar9": true,"attValue9": "5.2","attWritable9": false,"attPlotable9": false,"isNumeric9": true,"attDesc9": "Name: InternalPlus5Vsupply\nLabel: Internal 5V Supply\nWritable: READ\nData format:Scalar\nData type: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standard unit\nDispUnit: No display unit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: No description","attribute10": "TransBankVce","attScalar10": true,"attValue10": "0.0","attWritable10": false,"attPlotable10": false,"isNumeric10": true,"attDesc10": "Name: TransBankVce\nLabel: Trans. bank Vce\nWritable: READ\nData format: Scalar\nDatatype: DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: V\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: No description","attribute11": "WaterFlow","attScalar11": true,"attValue11": "0.5","attWritable11": false,"attPlotable11": false,"isNumeric11": true,"attDesc11": "Name: WaterFlow\nLabel: Water flow\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: L/Min\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: No description","attribute12": "Interlock","attScalar12": true,"attValue12": "false","attWritable12": false,"attPlotable12": false,"isNumeric12": false,"attDesc12": "Name: Interlock\nLabel: Interlock\nWritable: READ\nData format: Scalar\nData type:DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: Enabled if there is at least one active interlock","attribute13": "InterlockDcOvercurrent","attScalar13": true,"attValue13": "false","attWritable13": false,"attPlotable13": false,"isNumeric13": false,"attDesc13": "Name: InterlockDcOvercurrent\nLabel: Interlock DC overcurrent\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a DCovercurrent interlock.","attribute14": "InterlockDcOverload","attScalar14": true,"attValue14": "false","attWritable14": false,"attPlotable14": false,"isNumeric14": false,"attDesc14": "Name: InterlockDcOverload\nLabel: Interlock DC overload\nWritable: READ\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a DC overloadinterlock.","attribute15": "InterlockRegulationMode","attScalar15": true,"attValue15": "false","attWritable15": false,"attPlotable15": false,"isNumeric15": false,"attDesc15": "Name: InterlockRegulationMode\nLabel: Interlock regulation mode\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a regulationmode failure.","attribute16": "InterlockPhaseFailure","attScalar16": true,"attValue16": "false","attWritable16": false,"attPlotable16": false,"isNumeric16": false,"attDesc16": "Name: InterlockPhaseFailure\nLabel: Interlock Phase Failure\nWritable: READ\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a Phase failureinterlock.","attribute17": "InterlockEarthLeakage","attScalar17": true,"attValue17": "false","attWritable17": false,"attPlotable17": false,"isNumeric17": false,"attDesc17": "Name: InterlockEarthLeakage\nLabel: Interlock earth leakage\nWritable: READ\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a EarthLeakage interlock.","attribute18": "InterlockThermalBreaker","attScalar18": true,"attValue18": "false","attWritable18": false,"attPlotable18": false,"isNumeric18": false,"attDesc18": "Name: InterlockThermalBreaker\nLabel: Interlock thermal breaker\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a thermalbreaker interlock.","attribute19": "InterlockMpsOverTemperature","attScalar19": true,"attValue19": "false","attWritable19": false,"attPlotable19": false,"isNumeric19": false,"attDesc19": "Name: InterlockMpsOverTemperature\nLabel: Interlock MPS overtemperature\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a MPSovertemperature interlock.","attribute20": "InterlockSpare","attScalar20": true,"attValue20": "false","attWritable20": false,"attPlotable20": false,"isNumeric20": false,"attDesc20": "Name: InterlockSpare\nLabel: Interlock SPARE\nWritable: READ\nData format: Scalar\nDatatype: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: Nodisplay unit\nFormat: Not specified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Notspecified\nMax alarm: Not specified\nDescription: Enabled if the spare interlock is on","attribute21": "InterlockOneTransistor","attScalar21": true,"attValue21": "false","attWritable21": false,"attPlotable21": false,"isNumeric21": false,"attDesc21": "Name: InterlockOneTransistor\nLabel: Interlock One Transistor\nWritable: READ\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is an interlock foone transistor fault","attribute22": "InterlockPreRegulation","attScalar22": true,"attValue22": "false","attWritable22": false,"attPlotable22": false,"isNumeric22": false,"attDesc22": "Name: InterlockPreRegulation\nLabel: Interlock Pre-Regulation\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: True if the interlock is related tothe pre-regulation.","attribute23": "InterlockMpsWaterFlow","attScalar23": true,"attValue23": "false","attWritable23": false,"attPlotable23": false,"isNumeric23": false,"attDesc23": "Name: InterlockMpsWaterFlow\nLabel: Interlock for water-flow\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: True if the interlock is related tothe water-flow.","attribute24": "InterlockPanicButton","attScalar24": true,"attValue24": "false","attWritable24": false,"attPlotable24": false,"isNumeric24": false,"attDesc24": "Name: InterlockPanicButton\nLabel: Interlock panic button or door open\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the panic buttonhas been pressed or the door has been opened","attribute25": "InterlockMagnetWaterFlow","attScalar25": true,"attValue25": "false","attWritable25": false,"attPlotable25": false,"isNumeric25": false,"attDesc25": "Name: InterlockMagnetWaterFlow\nLabel: Interlock magnet water flow\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if there is a failure inthe magnet water flow system.","attribute26": "InterlockMagnetOverTemperature","attScalar26": true,"attValue26": "false","attWritable26": false,"attPlotable26": false,"isNumeric26": false,"attDesc26": "Name: InterlockMagnetOverTemperature\nLabel: Interlock magnet over temperature\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the magnet is toohot.","attribute27": "FirstInterlockDcOvercurrent","attScalar27": true,"attValue27": "false","attWritable27": false,"attPlotable27": false,"isNumeric27": false,"attDesc27": "Name: FirstInterlockDcOvercurrent\nLabel: First cause of interlock: DC overcurrent\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the DC overcurrentinterlock was the first detected interlock.","attribute28": "FirstInterlockDcOverload", "attScalar28": true,"attValue28": "false","attWritable28": false,"attPlotable28": false,"isNumeric28": false,"attDesc28": "Name: FirstInterlockDcOverload\nLabel: First cause of interlock: DC overload\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the DC overloadinterlock was the first detected interlock.","attribute29": "FirstInterlockRegulationMode","attScalar29": true,"attValue29": "false","attWritable29": false,"attPlotable29": false,"isNumeric29": false,"attDesc29": "Name: FirstInterlockRegulationMode\nLabel: First cause of interlock: Regulationmode\nWritable: READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit:No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Notspecified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription:Enabled if the Regulation Mode interlock was the first detected interlock.","attribute30": "FirstInterlockPhaseFailure","attScalar30": true,"attValue30": "false","attWritable30": false,"attPlotable30": false,"isNumeric30": false,"attDesc30": "Name: FirstInterlockPhaseFailure\nLabel: First cause of interlock: Phase Failure\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the Phase Failureinterlock was the first detected interlock.","attribute31": "FirstInterlockEarthLeakage","attScalar31": true,"attValue31": "false","attWritable31": false,"attPlotable31": false,"isNumeric31": false,"attDesc31": "Name: FirstInterlockEarthLeakage\nLabel: First cause of interlock: earth leakage\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the Earth leakageinterlock was the first detected interlock.","attribute32": "FirstInterlockThermalBreaker","attScalar32": true,"attValue32": "false","attWritable32": false,"attPlotable32": false,"isNumeric32": false,"attDesc32": "Name: FirstInterlockThermalBreaker\nLabel: First cause of interlock: thermal breaker\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the thermalbreaker failure interlock was the first detected interlock.","attribute33": "FirstInterlockMpsOverTemperature","attScalar33": true,"attValue33": "false","attWritable33": false,"attPlotable33": false,"isNumeric33": false,"attDesc33": "Name: FirstInterlockMpsOverTemperature\nLabel: First cause of interlock: MPSovertemperature\nWritable: READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax DimY: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value:Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription:Enabled if the MPS overtemperature interlock was the first detected interlock.","attribute34": "FirstInterlockPreRegulation","attScalar34": true,"attValue34": "false","attWritable34": false,"attPlotable34": false,"isNumeric34": false,"attDesc34": "Name: FirstInterlockPreRegulation\nLabel: First interlock: pre-regulation\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the first cause ofthe interlock was the pre-regulation.","attribute35": "FirstInterlockMpsWaterFlow","attScalar35": true,"attValue35": "false","attWritable35": false,"attPlotable35": false,"isNumeric35": false,"attDesc35": "Name: FirstInterlockMpsWaterFlow\nLabel: First interlock: MPS waterflow\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the first cause ofinterlock was the MPS waterflow.","attribute36": "FirstInterlockPanicButton","attScalar36": true,"attValue36": "false","attWritable36": false,"attPlotable36": false,"isNumeric36": false,"attDesc36": "Name: FirstInterlockPanicButton\nLabel: First interlock: panic button\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the first cause ofinterlock was the panic button or door open.","attribute37": "FirstInterlockMagnetWaterFlow","attScalar37": true,"attValue37": "false","attWritable37": false,"attPlotable37": false,"isNumeric37": false,"attDesc37": "Name: FirstInterlockMagnetWaterFlow\nLabel: First interlock: magnet water flow\nWritable:READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit:No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value:Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the first cause ofthe interlock was the magnet water flow.","attribute38": "FirstInterlockMagnetOverTemperature","attScalar38": true,"attValue38": "false","attWritable38": false,"attPlotable38": false,"isNumeric38": false,"attDesc38": "Name: FirstInterlockMagnetOverTemperature\nLabel: First interlock: magnet overtemperature\nWritable: READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y:0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value:Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription:Enabled if the first cause of the interlock was the magnet over temperature.","attribute39": "FirstInterlockSpare","attScalar39": true,"attValue39": "false","attWritable39": false,"attPlotable39": false,"isNumeric39": false,"attDesc39": "Name: FirstInterlockSpare\nLabel: First cause of interlock: SPARE\nWritable: READ\nDataformat: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: Enabled if the spare interlock wasthe first detected interlock.","attribute40": "FirstInterlockOneTransistor","attScalar40": true,"attValue40": "false","attWritable40": false,"attPlotable40": false,"isNumeric40": false,"attDesc40": "Name: FirstInterlockOneTransistor\nLabel: First cause of interlock: One TransistorFault\nWritable: READ\nData format: Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit:No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Notspecified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription:Enabled if the transistor fault was the first detected interlock.","attribute41": "Version","attScalar41": true,"attValue41": "1.0.0.1","attWritable41": false,"attPlotable41": false,"isNumeric41": false,"attDesc41": "Name: Version\nLabel: Device server version\nWritable: READ\nData format: Scalar\nDatatype: DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: Nodisplay unit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: The version (filled by the continuous integration tasks)","attribute42": "OutputOn","attScalar42": true,"attValue42": "true","attWritable42": true,"attPlotable42": false,"isNumeric42": false,"attDesc42": "Name: OutputOn\nLabel: Current output on\nWritable: READ_WRITE\nData format:Scalar\nData type: DevBoolean\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: READ: State of theoutput.\nWRITE: Mirrors the ON and OFF command of the device. Writing true will turn the device ON whilefalse will turn it OFF.\nThis feature was requested by Maxlab and it is used to restore the state of the device bythe snapshot tool. Use with caution.","attribute43": "Resistance","attScalar43": true,"attValue43": "0.0","attWritable43": false,"attPlotable43": false,"isNumeric43": true,"attDesc43": "Name: Resistance\nLabel: Resistance\nWritable: READ\nData format: Scalar\nData type:DevDouble\nMax Dim X: 1\nMax Dim Y: 0\nUnit: ohm\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %6.2f\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMaxalarm: Not specified\nDescription: The calculated resistance.","attribute44": "AllInterlocks","attScalar44": false,"attValue44": "false, false, false, false, false, false, false, false, false, false, false, false, false, false, ","attWritable44": false,"attPlotable44": false,"isNumeric44": false,"attDesc44": "Name: AllInterlocks\nLabel: Contains all the interlock statuses\nWritable: READ\nData format:Spectrum\nData type: DevBoolean\nMax Dim X: 14\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standardunit\nDisp Unit: No display unit\nFormat: Not specified\nMin value: Not specified\nMax value: Notspecified\nMin alarm: Not specified\nMax alarm: Not specified\nDescription: 0 = DC overcurrent\n1 = DCovervoltage\n2 = DC undervoltage\n3 = phase failure\n4 = earth leakage\n5 = fan failure\n6 = overtemperature\n7 = external 0\n8 = external 1\n9 = external 2\n10 = external 3","attribute45": "State","attScalar45": true,"attValue45": "ON","attWritable45": false,"attPlotable45": false,"isNumeric45": false,"attDesc45": "Name: State\nLabel: State\nWritable: READ\nData format: Scalar\nData type: State\nMax DimX: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No display unit\nFormat: Notspecified\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm: Notspecified\nDescription: No description","attribute46": "Status","attScalar46": true,"attValue46": "The device is on","attWritable46": false,"attPlotable46": false,"isNumeric46": false,"attDesc46": "Name: Status\nLabel: Status\nWritable: READ\nData format: Scalar\nData type:DevString\nMax Dim X: 1\nMax Dim Y: 0\nUnit: No unit\nStd Unit: No standard unit\nDisp Unit: No displayunit\nFormat: %s\nMin value: Not specified\nMax value: Not specified\nMin alarm: Not specified\nMax alarm:Not specified\nDescription: No description","connectionStatus": "OK"} '
			elif self.dev == 'invalid-json':
				response = ' Some invalid JSON code '
			# --------------dane do testow

		try:
			self.attList = json.loads(re.sub(r'\n', '&#13;', response))		# zamieniam \n na line break dla tooltipow HTML
		except Exception as e:
			self.error = "Invalid JSON:<br>" + str(e)
			return